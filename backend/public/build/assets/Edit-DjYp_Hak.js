import{a as D,u as b,j as e,L as g,r as q}from"./app-OLZiEXpJ.js";import{A as C}from"./AdminLayout-DfTbawBB.js";import{a as u}from"./adminPath-BxB_o4uP.js";/* empty css            */const w=a=>{if(!a)return"";const l=new Date(a);if(Number.isNaN(l.getTime()))return"";const n=d=>String(d).padStart(2,"0");return`${l.getFullYear()}-${n(l.getMonth()+1)}-${n(l.getDate())}T${n(l.getHours())}:${n(l.getMinutes())}`};function L({trader:a,assets:l,active_followers:n,trade_history:d=[]}){const{url:c}=D(),t=b({display_name:a.display_name||"",username:a.username||"",avatar_color:a.avatar_color||"",strategy:a.strategy||"",copy_fee:a.copy_fee??0,total_return:a.total_return??0,win_rate:a.win_rate??0,copiers_count:a.copiers_count??0,risk_score:a.risk_score??1,joined_at:w(a.joined_at),is_verified:!!a.is_verified,is_active:!!a.is_active}),m=l?.[0]??null,s=b({asset_id:m?.id||"",side:"buy",quantity:"",price:m?.price??"",executed_at:"",pnl:"",note:""}),y=r=>{r.preventDefault(),t.put(u(c,`copy-traders/${a.id}`))},v=()=>{window.confirm("Delete this copy trader? This will remove all related follower relationships.")&&q.delete(u(c,`copy-traders/${a.id}`))},f=r=>{r.preventDefault(),s.post(u(c,`copy-traders/${a.id}/trades`),{preserveScroll:!0,onSuccess:()=>{s.reset("quantity","pnl","note","executed_at")}})},_=r=>{s.setData("asset_id",r);const x=l.find(p=>p.id===r);x&&s.setData("price",x.price)},h=Array.isArray(d)?d:[];return e.jsx(C,{title:`Edit ${a.display_name}`,children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.2fr,0.8fr]",children:[e.jsxs("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-100",children:"Trader Details"}),e.jsx("p",{className:"mt-1 text-sm text-slate-400",children:"Update copy trader stats and profile info."})]}),e.jsx(g,{href:u(c,"copy-traders"),className:"rounded-xl border border-slate-700 px-4 py-2 text-xs text-slate-200 transition hover:border-slate-500 hover:bg-slate-800",children:"Back to list"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:"Display Name",error:t.errors.display_name,required:!0,children:e.jsx("input",{type:"text",value:t.data.display_name,onChange:r=>t.setData("display_name",r.target.value),className:i(t.errors.display_name),required:!0})}),e.jsx(o,{label:"Username",error:t.errors.username,required:!0,children:e.jsx("input",{type:"text",value:t.data.username,onChange:r=>t.setData("username",r.target.value),className:i(t.errors.username),required:!0})}),e.jsx(o,{label:"Avatar Color",error:t.errors.avatar_color,children:e.jsx("input",{type:"text",value:t.data.avatar_color,onChange:r=>t.setData("avatar_color",r.target.value),className:i(t.errors.avatar_color),placeholder:"emerald"})}),e.jsx(o,{label:"Strategy",error:t.errors.strategy,required:!0,children:e.jsx("input",{type:"text",value:t.data.strategy,onChange:r=>t.setData("strategy",r.target.value),className:i(t.errors.strategy),required:!0})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:"Copy Fee ($)",error:t.errors.copy_fee,required:!0,children:e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.data.copy_fee,onChange:r=>t.setData("copy_fee",r.target.value),className:i(t.errors.copy_fee),required:!0})}),e.jsx(o,{label:"Total Return (%)",error:t.errors.total_return,required:!0,children:e.jsx("input",{type:"number",step:"0.01",value:t.data.total_return,onChange:r=>t.setData("total_return",r.target.value),className:i(t.errors.total_return),required:!0})}),e.jsx(o,{label:"Win Rate (%)",error:t.errors.win_rate,required:!0,children:e.jsx("input",{type:"number",step:"0.01",value:t.data.win_rate,onChange:r=>t.setData("win_rate",r.target.value),className:i(t.errors.win_rate),required:!0})}),e.jsx(o,{label:"Copiers Count",error:t.errors.copiers_count,required:!0,children:e.jsx("input",{type:"number",step:"1",value:t.data.copiers_count,onChange:r=>t.setData("copiers_count",r.target.value),className:i(t.errors.copiers_count),required:!0})}),e.jsx(o,{label:"Risk Score (1-10)",error:t.errors.risk_score,required:!0,children:e.jsx("input",{type:"number",step:"1",min:"1",max:"10",value:t.data.risk_score,onChange:r=>t.setData("risk_score",r.target.value),className:i(t.errors.risk_score),required:!0})})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.jsx(o,{label:"Joined At",error:t.errors.joined_at,required:!0,children:e.jsx("input",{type:"datetime-local",value:t.data.joined_at,onChange:r=>t.setData("joined_at",r.target.value),className:i(t.errors.joined_at),required:!0})})}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsx(j,{label:"Verified",checked:t.data.is_verified,onChange:r=>t.setData("is_verified",r)}),e.jsx(j,{label:"Active",checked:t.data.is_active,onChange:r=>t.setData("is_active",r)})]}),(t.errors.is_verified||t.errors.is_active)&&e.jsx("p",{className:"text-xs text-rose-300",children:t.errors.is_verified||t.errors.is_active}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:t.processing,className:"rounded-xl bg-gradient-to-r from-cyan-500 to-emerald-500 px-5 py-2.5 text-sm font-semibold text-slate-950 transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60",children:t.processing?"Saving...":"Save Changes"}),e.jsx(g,{href:u(c,"copy-traders"),className:"rounded-xl border border-slate-700 px-5 py-2.5 text-sm text-slate-200 transition hover:border-slate-500 hover:bg-slate-800",children:"Cancel"}),e.jsx("button",{type:"button",onClick:v,className:"rounded-xl border border-rose-500/50 px-5 py-2.5 text-sm font-semibold text-rose-200 transition hover:border-rose-400 hover:bg-rose-500/10",children:"Delete Trader"})]})]})]}),e.jsxs("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/70 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-100",children:"Execute Copy Trade"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-400",children:["Applies the trade to ",n," active follower",n===1?"":"s",". Quantity and PnL scale by each follower's copy ratio."]})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx(o,{label:"Asset",error:s.errors.asset_id,required:!0,children:e.jsxs("select",{value:s.data.asset_id,onChange:r=>_(r.target.value),className:i(s.errors.asset_id),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Select an asset"}),l.map(r=>e.jsxs("option",{value:r.id,children:[r.symbol," · ",r.name]},r.id))]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:"Side",error:s.errors.side,required:!0,children:e.jsxs("select",{value:s.data.side,onChange:r=>s.setData("side",r.target.value),className:i(s.errors.side),required:!0,children:[e.jsx("option",{value:"buy",children:"Buy"}),e.jsx("option",{value:"sell",children:"Sell"})]})}),e.jsx(o,{label:"Quantity (Leader)",error:s.errors.quantity,required:!0,children:e.jsx("input",{type:"number",step:"0.00000001",value:s.data.quantity,onChange:r=>s.setData("quantity",r.target.value),className:i(s.errors.quantity),required:!0})}),e.jsx(o,{label:"Price",error:s.errors.price,required:!0,children:e.jsx("input",{type:"number",step:"0.0001",value:s.data.price,onChange:r=>s.setData("price",r.target.value),className:i(s.errors.price),required:!0})}),e.jsx(o,{label:"Executed At",error:s.errors.executed_at,children:e.jsx("input",{type:"datetime-local",value:s.data.executed_at,onChange:r=>s.setData("executed_at",r.target.value),className:i(s.errors.executed_at)})})]}),e.jsx(o,{label:"PnL (Leader Trade)",error:s.errors.pnl,children:e.jsx("input",{type:"number",step:"0.01",value:s.data.pnl,onChange:r=>s.setData("pnl",r.target.value),className:i(s.errors.pnl),placeholder:"Optional"})}),e.jsx(o,{label:"Internal Note",error:s.errors.note,children:e.jsx("input",{type:"text",value:s.data.note,onChange:r=>s.setData("note",r.target.value),className:i(s.errors.note),placeholder:"Optional note for the metadata"})}),e.jsx("button",{type:"submit",disabled:s.processing||n===0,className:"w-full rounded-xl bg-gradient-to-r from-emerald-500 to-cyan-500 px-5 py-2.5 text-sm font-semibold text-slate-950 transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60",children:s.processing?"Executing...":"Execute Trade"})]})]}),e.jsxs("section",{className:"lg:col-span-2 rounded-2xl border border-slate-800 bg-slate-900/70 p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-100",children:"Trade History"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-400",children:["Use ",e.jsx("strong",{children:"Execute Copy Trade"})," above to add history entries for this copy trader."]})]}),h.length===0?e.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-950/70 p-4 text-sm text-slate-400",children:"No trade history yet for this copy trader."}):e.jsx("div",{className:"space-y-3",children:h.map(r=>{const x=Number(r.pnl||0)>=0,p=r?.follower?.name||r?.follower?.email||"Unknown follower",N=r?.asset?.symbol||"N/A";return e.jsxs("article",{className:"rounded-xl border border-slate-800 bg-slate-950/70 p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-100",children:[String(r.side||"").toUpperCase()," ",N]}),e.jsxs("p",{className:"text-xs text-slate-400",children:[p," • ",r.executed_at?new Date(r.executed_at).toLocaleString():"-"]}),r?.metadata?.note?e.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Note: ",r.metadata.note]}):null]}),e.jsx("p",{className:`text-lg font-semibold ${x?"text-emerald-400":"text-rose-400"}`,children:Number(r.pnl||0).toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"mt-3 grid gap-2 text-xs text-slate-400 sm:grid-cols-3",children:[e.jsxs("p",{children:["Quantity: ",Number(r.quantity||0).toLocaleString()]}),e.jsxs("p",{children:["Price: ",Number(r.price||0).toLocaleString(void 0,{style:"currency",currency:"USD"})]}),e.jsxs("p",{children:["Ratio: ",r?.metadata?.copy_ratio??"-"]})]})]},r.id)})})]})]})})}function o({label:a,error:l,children:n,required:d=!1}){return e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"mb-2 block text-sm text-slate-300",children:[a," ",d?e.jsx("span",{className:"text-rose-300",children:"*"}):null]}),n,l&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:l})]})}function j({label:a,checked:l,onChange:n}){return e.jsxs("label",{className:"flex items-center justify-between rounded-xl border border-slate-700 bg-slate-950/70 px-4 py-3 text-sm text-slate-200",children:[e.jsx("span",{children:a}),e.jsx("button",{type:"button",onClick:()=>n(!l),className:`relative h-6 w-11 rounded-full transition ${l?"bg-emerald-500":"bg-slate-700"}`,children:e.jsx("span",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white transition ${l?"left-5":"left-0.5"}`})})]})}const i=a=>`w-full rounded-xl border px-3 py-2.5 text-sm outline-none transition ${a?"border-rose-500/60 bg-rose-500/10 text-rose-100 focus:border-rose-400":"border-slate-700 bg-slate-950 text-slate-100 focus:border-cyan-400"}`;export{L as default};
