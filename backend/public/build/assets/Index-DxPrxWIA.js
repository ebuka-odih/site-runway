import{r as i,u as $,j as e,L as o,a as w}from"./app-CnvC2WdQ.js";import{A as P}from"./AdminLayout-Dz3I6PMh.js";/* empty css            */const _=a=>a?new Date(a).toLocaleString():"-",r=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(Number(a||0));function B({users:a,filters:n,stats:d}){const[m,k]=i.useState(n.search||""),[p,C]=i.useState(n.role||"all"),[b,S]=i.useState(n.verification||"all"),[l,g]=i.useState(null),f=i.useRef(!1),N=Array.isArray(a?.data)?a.data:[],U=Array.isArray(a?.links)?a.links:[],t=$({target:"balance",amount:"",notes:"",redirect_to:"index"}),A=(s,h,F)=>{w.get("/admin/users",{search:s,role:h,verification:F,page:1},{preserveState:!1,replace:!0,preserveScroll:!0})};i.useEffect(()=>{if(!f.current){f.current=!0;return}const s=window.setTimeout(()=>{A(m,p,b)},350);return()=>window.clearTimeout(s)},[m,p,b]);const y=(s,h)=>{window.confirm(`Delete ${h}? This action cannot be undone.`)&&w.delete(`/admin/users/${s}`)},v=s=>{g(s),t.clearErrors(),t.setData("target","balance"),t.setData("amount",""),t.setData("notes",""),t.setData("redirect_to","index")},c=()=>{g(null),t.clearErrors()},D=s=>{s.preventDefault(),l&&t.post(l.fund_url||`/admin/users/${l.id}/fund`,{preserveScroll:!0,onSuccess:c})};return e.jsxs(P,{title:"User Management",children:[e.jsxs("section",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:[e.jsx(x,{label:"Total Users",value:d.total_users}),e.jsx(x,{label:"Admin Users",value:d.admin_users}),e.jsx(x,{label:"Verified Users",value:d.verified_users}),e.jsx(x,{label:"Pending KYC",value:d.pending_kyc})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-800 bg-slate-900/70 p-4 sm:p-5",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Manage Users"}),e.jsx(o,{href:"/admin/users/create",className:"rounded-xl bg-gradient-to-r from-cyan-500 to-emerald-500 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:opacity-90",children:"Create User"})]}),e.jsxs("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>k(s.target.value),placeholder:"Search by name, email, or username",className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400 md:col-span-2"}),e.jsxs("select",{value:p,onChange:s=>C(s.target.value),className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400",children:[e.jsx("option",{value:"all",children:"All roles"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"user",children:"Users"})]}),e.jsxs("select",{value:b,onChange:s=>S(s.target.value),className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400",children:[e.jsx("option",{value:"all",children:"All verification states"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"unverified",children:"Unverified"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Search and filters apply automatically while typing."}),e.jsx("div",{className:"mt-5 space-y-3 md:hidden",children:N.map(s=>e.jsxs("article",{className:"rounded-xl border border-slate-800 bg-slate-950/70 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-100",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500",children:s.email}),e.jsxs("p",{className:"text-xs text-slate-500",children:["@",s.username]})]}),e.jsx("span",{className:`rounded-full px-2 py-1 text-xs uppercase ${s.is_admin?"bg-cyan-500/20 text-cyan-200":"bg-slate-700 text-slate-200"}`,children:s.is_admin?"Admin":"User"})]}),e.jsxs("dl",{className:"mt-3 space-y-1 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Tier"}),e.jsx("dd",{className:"uppercase text-slate-200",children:s.membership_tier})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"KYC"}),e.jsx("dd",{className:"uppercase text-slate-200",children:s.kyc_status})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Balance"}),e.jsx("dd",{className:"text-slate-200",children:r(s.balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Profit"}),e.jsx("dd",{className:"text-slate-200",children:r(s.profit_balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Holding"}),e.jsx("dd",{className:"text-slate-200",children:r(s.holding_balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Orders / Positions"}),e.jsxs("dd",{className:"text-slate-300",children:[s.orders_count," / ",s.positions_count]})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Joined"}),e.jsx("dd",{className:"text-slate-300",children:_(s.created_at)})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center justify-between gap-2",children:[e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s.email_verified?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-200"}`,children:s.email_verified?"Verified":"Pending"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{href:`/admin/users/${s.id}/edit`,className:"rounded-lg border border-slate-600 px-2.5 py-1 text-xs text-slate-200 transition hover:border-cyan-400 hover:text-cyan-200",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>v(s),className:"rounded-lg border border-amber-500/60 px-2.5 py-1 text-xs text-amber-200 transition hover:bg-amber-500/10",children:"Fund"}),e.jsx("button",{type:"button",onClick:()=>y(s.id,s.name),className:"rounded-lg border border-rose-500/60 px-2.5 py-1 text-xs text-rose-200 transition hover:bg-rose-500/10",children:"Delete"})]})]})]},s.id))}),e.jsx("div",{className:"mt-5 hidden overflow-x-auto md:block",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 pr-3",children:"User"}),e.jsx("th",{className:"pb-3 pr-3",children:"Role"}),e.jsx("th",{className:"pb-3 pr-3",children:"Tier / KYC"}),e.jsx("th",{className:"pb-3 pr-3",children:"Funds"}),e.jsx("th",{className:"pb-3 pr-3",children:"Activity"}),e.jsx("th",{className:"pb-3 pr-3",children:"Verified"}),e.jsx("th",{className:"pb-3",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800 text-slate-300",children:N.map(s=>e.jsxs("tr",{className:"transition hover:bg-slate-800/30",children:[e.jsxs("td",{className:"py-3 pr-3",children:[e.jsx("p",{className:"font-medium text-slate-100",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500",children:s.email}),e.jsxs("p",{className:"text-xs text-slate-500",children:["@",s.username]})]}),e.jsx("td",{className:"py-3 pr-3",children:e.jsx("span",{className:`rounded-full px-2 py-1 text-xs uppercase ${s.is_admin?"bg-cyan-500/20 text-cyan-200":"bg-slate-700 text-slate-200"}`,children:s.is_admin?"Admin":"User"})}),e.jsxs("td",{className:"py-3 pr-3 text-xs uppercase text-slate-300",children:[e.jsx("p",{children:s.membership_tier}),e.jsxs("p",{className:"mt-1 text-slate-500",children:["KYC: ",s.kyc_status]})]}),e.jsxs("td",{className:"py-3 pr-3 text-xs text-slate-300",children:[e.jsxs("p",{children:["Balance: ",r(s.balance)]}),e.jsxs("p",{children:["Profit: ",r(s.profit_balance)]}),e.jsxs("p",{className:"mt-1",children:["Holding: ",r(s.holding_balance)]})]}),e.jsxs("td",{className:"py-3 pr-3 text-xs text-slate-400",children:[e.jsxs("p",{children:["Orders: ",s.orders_count]}),e.jsxs("p",{children:["Positions: ",s.positions_count]}),e.jsxs("p",{className:"mt-1",children:["Joined: ",_(s.created_at)]})]}),e.jsx("td",{className:"py-3 pr-3",children:e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s.email_verified?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-200"}`,children:s.email_verified?"Verified":"Pending"})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{href:`/admin/users/${s.id}/edit`,className:"rounded-lg border border-slate-600 px-2.5 py-1 text-xs text-slate-200 transition hover:border-cyan-400 hover:text-cyan-200",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>v(s),className:"rounded-lg border border-amber-500/60 px-2.5 py-1 text-xs text-amber-200 transition hover:bg-amber-500/10",children:"Fund"}),e.jsx("button",{type:"button",onClick:()=>y(s.id,s.name),className:"rounded-lg border border-rose-500/60 px-2.5 py-1 text-xs text-rose-200 transition hover:bg-rose-500/10",children:"Delete"})]})})]},s.id))})]})}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:U.map(s=>e.jsx(o,{href:s.url||"#",preserveState:!0,preserveScroll:!0,className:`rounded-lg border px-3 py-1.5 text-xs transition ${s.active?"border-cyan-400 bg-cyan-500/20 text-cyan-100":s.url?"border-slate-700 text-slate-300 hover:border-cyan-500/40":"cursor-not-allowed border-slate-800 text-slate-600"}`,dangerouslySetInnerHTML:{__html:s.label}},s.label))})]}),l&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950/80 p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0",onClick:c,"aria-label":"Close funding modal"}),e.jsxs("section",{className:"relative z-10 w-full max-w-xl rounded-2xl border border-slate-700 bg-slate-900 p-5 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-100",children:"Fund User Account"}),e.jsxs("p",{className:"text-xs text-slate-400",children:[l.name," (",l.email,")"]})]}),e.jsx("button",{type:"button",onClick:c,className:"rounded-lg border border-slate-700 px-2 py-1 text-xs text-slate-300 transition hover:bg-slate-800",children:"Close"})]}),e.jsxs("div",{className:"mt-4 grid gap-2 text-xs text-slate-300 sm:grid-cols-3",children:[e.jsx(u,{label:"Balance",value:r(l.balance)}),e.jsx(u,{label:"Profit",value:r(l.profit_balance)}),e.jsx(u,{label:"Holding",value:r(l.holding_balance)})]}),e.jsxs("form",{onSubmit:D,className:"mt-5 space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"mb-2 block text-sm text-slate-300",children:["Target ",e.jsx("span",{className:"text-rose-300",children:"*"})]}),e.jsxs("select",{value:t.data.target,onChange:s=>t.setData("target",s.target.value),className:j(t.errors.target),required:!0,children:[e.jsx("option",{value:"balance",children:"Balance"}),e.jsx("option",{value:"profit_balance",children:"Profit Balance"}),e.jsx("option",{value:"holding_balance",children:"Holding Balance"})]}),t.errors.target&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.target})]}),e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"mb-2 block text-sm text-slate-300",children:["Amount (USD) ",e.jsx("span",{className:"text-rose-300",children:"*"})]}),e.jsx("input",{type:"number",min:"0.01",step:"0.01",value:t.data.amount,onChange:s=>t.setData("amount",s.target.value),className:j(t.errors.amount),placeholder:"100.00",required:!0}),t.errors.amount&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.amount})]}),e.jsxs("label",{className:"block sm:col-span-2",children:[e.jsx("span",{className:"mb-2 block text-sm text-slate-300",children:"Notes"}),e.jsx("input",{type:"text",value:t.data.notes,onChange:s=>t.setData("notes",s.target.value),className:j(t.errors.notes),placeholder:"Optional audit note"}),t.errors.notes&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.notes})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"submit",disabled:t.processing,className:"rounded-lg bg-gradient-to-r from-amber-400 to-orange-500 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60",children:t.processing?"Funding...":"Fund Account"}),e.jsx("button",{type:"button",onClick:c,className:"rounded-lg border border-slate-700 px-4 py-2 text-sm text-slate-200 transition hover:bg-slate-800",children:"Cancel"})]})]})]})]})]})}function x({label:a,value:n}){return e.jsxs("article",{className:"rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:a}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-100",children:n})]})}function u({label:a,value:n}){return e.jsxs("article",{className:"rounded-xl border border-slate-700 bg-slate-950/70 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-[0.15em] text-slate-400",children:a}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-100",children:n})]})}const j=a=>`w-full rounded-xl border px-3 py-2.5 text-sm outline-none transition ${a?"border-rose-500/60 bg-rose-500/10 text-rose-100 focus:border-rose-400":"border-slate-700 bg-slate-950 text-slate-100 focus:border-cyan-400"}`;export{B as default};
