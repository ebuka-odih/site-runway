import{u as M,r as d,a as B,j as e,L as p,b as C}from"./app-DIo57JqX.js";import{A as I}from"./AdminLayout-CAMTXasa.js";import{a as c}from"./adminPath-BxB_o4uP.js";/* empty css            */const S=a=>a?new Date(a).toLocaleString():"-",l=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(Number(a||0));function K({users:a,filters:n,stats:x}){const{url:i}=M(),U=c(i,"users"),[u,A]=d.useState(n.search||""),[h,D]=d.useState(n.role||"all"),[j,F]=d.useState(n.verification||"all"),[r,N]=d.useState(null),y=d.useRef(!1),v=Array.isArray(a?.data)?a.data:[],P=Array.isArray(a?.links)?a.links:[],t=B({target:"balance",operation:"fund",amount:"",notes:"",redirect_to:"index"}),$=(s,o,E)=>{C.get(U,{search:s,role:o,verification:E,page:1},{preserveState:!1,replace:!0,preserveScroll:!0})};d.useEffect(()=>{if(!y.current){y.current=!0;return}const s=window.setTimeout(()=>{$(u,h,j)},350);return()=>window.clearTimeout(s)},[u,h,j]);const w=(s,o)=>{window.confirm(`Delete ${o}? This action cannot be undone.`)&&C.delete(c(i,`users/${s}`))},_=s=>{N(s),t.clearErrors(),t.setData("target","balance"),t.setData("operation","fund"),t.setData("amount",""),t.setData("notes",""),t.setData("redirect_to","index")},m=()=>{N(null),t.clearErrors()},T=s=>{s.preventDefault(),k("fund")},k=s=>{r&&(t.transform(o=>({...o,operation:s})),t.post(c(i,`users/${r.id}/fund`),{preserveScroll:!0,onSuccess:m}))};return e.jsxs(I,{title:"User Management",children:[e.jsxs("section",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:[e.jsx(b,{label:"Total Users",value:x.total_users}),e.jsx(b,{label:"Admin Users",value:x.admin_users}),e.jsx(b,{label:"Verified Users",value:x.verified_users}),e.jsx(b,{label:"Pending KYC",value:x.pending_kyc})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-800 bg-slate-900/70 p-4 sm:p-5",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Manage Users"}),e.jsx(p,{href:c(i,"users/create"),className:"rounded-xl bg-gradient-to-r from-cyan-500 to-emerald-500 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:opacity-90",children:"Create User"})]}),e.jsxs("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[e.jsx("input",{type:"text",value:u,onChange:s=>A(s.target.value),placeholder:"Search by name, email, or username",className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400 md:col-span-2"}),e.jsxs("select",{value:h,onChange:s=>D(s.target.value),className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400",children:[e.jsx("option",{value:"all",children:"All roles"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"user",children:"Users"})]}),e.jsxs("select",{value:j,onChange:s=>F(s.target.value),className:"rounded-xl border border-slate-700 bg-slate-950 px-3 py-2.5 text-sm text-slate-100 outline-none transition focus:border-cyan-400",children:[e.jsx("option",{value:"all",children:"All verification states"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"unverified",children:"Unverified"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Search and filters apply automatically while typing."}),e.jsx("div",{className:"mt-5 space-y-3 md:hidden",children:v.map(s=>e.jsxs("article",{className:"rounded-xl border border-slate-800 bg-slate-950/70 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-100",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500",children:s.email}),e.jsxs("p",{className:"text-xs text-slate-500",children:["@",s.username]})]}),e.jsx("span",{className:`rounded-full px-2 py-1 text-xs uppercase ${s.is_admin?"bg-cyan-500/20 text-cyan-200":"bg-slate-700 text-slate-200"}`,children:s.is_admin?"Admin":"User"})]}),e.jsxs("dl",{className:"mt-3 space-y-1 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Tier"}),e.jsx("dd",{className:"uppercase text-slate-200",children:s.membership_tier})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"KYC"}),e.jsx("dd",{className:"uppercase text-slate-200",children:s.kyc_status})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Balance"}),e.jsx("dd",{className:"text-slate-200",children:l(s.balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Profit"}),e.jsx("dd",{className:"text-slate-200",children:l(s.profit_balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Holding"}),e.jsx("dd",{className:"text-slate-200",children:l(s.holding_balance)})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Orders / Positions"}),e.jsxs("dd",{className:"text-slate-300",children:[s.orders_count," / ",s.positions_count]})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Joined"}),e.jsx("dd",{className:"text-slate-300",children:S(s.created_at)})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center justify-between gap-2",children:[e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s.email_verified?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-200"}`,children:s.email_verified?"Verified":"Pending"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(p,{href:c(i,`users/${s.id}/edit`),className:"rounded-lg border border-slate-600 px-2.5 py-1 text-xs text-slate-200 transition hover:border-cyan-400 hover:text-cyan-200",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>_(s),className:"rounded-lg border border-amber-500/60 px-2.5 py-1 text-xs text-amber-200 transition hover:bg-amber-500/10",children:"Fund"}),e.jsx("button",{type:"button",onClick:()=>w(s.id,s.name),className:"rounded-lg border border-rose-500/60 px-2.5 py-1 text-xs text-rose-200 transition hover:bg-rose-500/10",children:"Delete"})]})]})]},s.id))}),e.jsx("div",{className:"mt-5 hidden overflow-x-auto md:block",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 pr-3",children:"User"}),e.jsx("th",{className:"pb-3 pr-3",children:"Role"}),e.jsx("th",{className:"pb-3 pr-3",children:"Tier / KYC"}),e.jsx("th",{className:"pb-3 pr-3",children:"Funds"}),e.jsx("th",{className:"pb-3 pr-3",children:"Activity"}),e.jsx("th",{className:"pb-3 pr-3",children:"Verified"}),e.jsx("th",{className:"pb-3",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800 text-slate-300",children:v.map(s=>e.jsxs("tr",{className:"transition hover:bg-slate-800/30",children:[e.jsxs("td",{className:"py-3 pr-3",children:[e.jsx("p",{className:"font-medium text-slate-100",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500",children:s.email}),e.jsxs("p",{className:"text-xs text-slate-500",children:["@",s.username]})]}),e.jsx("td",{className:"py-3 pr-3",children:e.jsx("span",{className:`rounded-full px-2 py-1 text-xs uppercase ${s.is_admin?"bg-cyan-500/20 text-cyan-200":"bg-slate-700 text-slate-200"}`,children:s.is_admin?"Admin":"User"})}),e.jsxs("td",{className:"py-3 pr-3 text-xs uppercase text-slate-300",children:[e.jsx("p",{children:s.membership_tier}),e.jsxs("p",{className:"mt-1 text-slate-500",children:["KYC: ",s.kyc_status]})]}),e.jsxs("td",{className:"py-3 pr-3 text-xs text-slate-300",children:[e.jsxs("p",{children:["Balance: ",l(s.balance)]}),e.jsxs("p",{children:["Profit: ",l(s.profit_balance)]}),e.jsxs("p",{className:"mt-1",children:["Holding: ",l(s.holding_balance)]})]}),e.jsxs("td",{className:"py-3 pr-3 text-xs text-slate-400",children:[e.jsxs("p",{children:["Orders: ",s.orders_count]}),e.jsxs("p",{children:["Positions: ",s.positions_count]}),e.jsxs("p",{className:"mt-1",children:["Joined: ",S(s.created_at)]})]}),e.jsx("td",{className:"py-3 pr-3",children:e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s.email_verified?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-200"}`,children:s.email_verified?"Verified":"Pending"})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(p,{href:c(i,`users/${s.id}/edit`),className:"rounded-lg border border-slate-600 px-2.5 py-1 text-xs text-slate-200 transition hover:border-cyan-400 hover:text-cyan-200",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>_(s),className:"rounded-lg border border-amber-500/60 px-2.5 py-1 text-xs text-amber-200 transition hover:bg-amber-500/10",children:"Fund"}),e.jsx("button",{type:"button",onClick:()=>w(s.id,s.name),className:"rounded-lg border border-rose-500/60 px-2.5 py-1 text-xs text-rose-200 transition hover:bg-rose-500/10",children:"Delete"})]})})]},s.id))})]})}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:P.map(s=>e.jsx(p,{href:s.url||"#",preserveState:!0,preserveScroll:!0,className:`rounded-lg border px-3 py-1.5 text-xs transition ${s.active?"border-cyan-400 bg-cyan-500/20 text-cyan-100":s.url?"border-slate-700 text-slate-300 hover:border-cyan-500/40":"cursor-not-allowed border-slate-800 text-slate-600"}`,dangerouslySetInnerHTML:{__html:s.label}},s.label))})]}),r&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950/80 p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0",onClick:m,"aria-label":"Close funding modal"}),e.jsxs("section",{className:"relative z-10 w-full max-w-xl rounded-2xl border border-slate-700 bg-slate-900 p-5 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-100",children:"Fund User Account"}),e.jsxs("p",{className:"text-xs text-slate-400",children:[r.name," (",r.email,")"]})]}),e.jsx("button",{type:"button",onClick:m,className:"rounded-lg border border-slate-700 px-2 py-1 text-xs text-slate-300 transition hover:bg-slate-800",children:"Close"})]}),e.jsxs("div",{className:"mt-4 grid gap-2 text-xs text-slate-300 sm:grid-cols-3",children:[e.jsx(g,{label:"Balance",value:l(r.balance)}),e.jsx(g,{label:"Profit",value:l(r.profit_balance)}),e.jsx(g,{label:"Holding",value:l(r.holding_balance)})]}),e.jsxs("form",{onSubmit:T,className:"mt-5 space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"mb-2 block text-sm text-slate-300",children:["Target ",e.jsx("span",{className:"text-rose-300",children:"*"})]}),e.jsxs("select",{value:t.data.target,onChange:s=>t.setData("target",s.target.value),className:f(t.errors.target),required:!0,children:[e.jsx("option",{value:"balance",children:"Balance"}),e.jsx("option",{value:"profit_balance",children:"Profit Balance"}),e.jsx("option",{value:"holding_balance",children:"Holding Balance"})]}),t.errors.target&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.target})]}),e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"mb-2 block text-sm text-slate-300",children:["Amount (USD) ",e.jsx("span",{className:"text-rose-300",children:"*"})]}),e.jsx("input",{type:"number",min:"0.01",step:"0.01",value:t.data.amount,onChange:s=>t.setData("amount",s.target.value),className:f(t.errors.amount),placeholder:"100.00",required:!0}),t.errors.amount&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.amount})]}),e.jsxs("label",{className:"block sm:col-span-2",children:[e.jsx("span",{className:"mb-2 block text-sm text-slate-300",children:"Notes"}),e.jsx("input",{type:"text",value:t.data.notes,onChange:s=>t.setData("notes",s.target.value),className:f(t.errors.notes),placeholder:"Optional audit note"}),t.errors.notes&&e.jsx("span",{className:"mt-1 block text-xs text-rose-300",children:t.errors.notes})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"submit",disabled:t.processing,className:"rounded-lg bg-gradient-to-r from-amber-400 to-orange-500 px-4 py-2 text-sm font-semibold text-slate-950 transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60",children:t.processing?"Processing...":"Fund Account"}),e.jsx("button",{type:"button",onClick:()=>k("deduct"),disabled:t.processing,className:"rounded-lg bg-gradient-to-r from-rose-500 to-red-600 px-4 py-2 text-sm font-semibold text-white transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-60",children:t.processing?"Processing...":"Deduct"}),e.jsx("button",{type:"button",onClick:m,className:"rounded-lg border border-slate-700 px-4 py-2 text-sm text-slate-200 transition hover:bg-slate-800",children:"Cancel"})]})]})]})]})]})}function b({label:a,value:n}){return e.jsxs("article",{className:"rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:a}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-100",children:n})]})}function g({label:a,value:n}){return e.jsxs("article",{className:"rounded-xl border border-slate-700 bg-slate-950/70 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-[0.15em] text-slate-400",children:a}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-slate-100",children:n})]})}const f=a=>`w-full rounded-xl border px-3 py-2.5 text-sm outline-none transition ${a?"border-rose-500/60 bg-rose-500/10 text-rose-100 focus:border-rose-400":"border-slate-700 bg-slate-950 text-slate-100 focus:border-cyan-400"}`;export{K as default};
